{"ip":"::ffff:127.0.0.1","level":"error","message":"txnRef is not defined","method":"POST","stack":"ReferenceError: txnRef is not defined\n    at createPaymentUrl (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\vnpay.controller.js:44:55)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-20T04:52:13.862Z","url":"/api/vnpay/create-payment-url"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"txnRef is not defined","method":"POST","stack":"ReferenceError: txnRef is not defined\n    at createPaymentUrl (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\vnpay.controller.js:44:55)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-20T04:52:45.341Z","url":"/api/vnpay/create-payment-url"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Failed to fetch zones: Unknown column 'so_ban' in 'field list'","method":"GET","stack":"Error: Failed to fetch zones: Unknown column 'so_ban' in 'field list'\n    at KhuVucModel.findAll (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\khuVuc.model.js:65:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async KhuVucService.getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\KhuVucService.js:26:12)\n    at async getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\khuVuc.controller.js:16:24)","timestamp":"2025-06-23T01:54:06.677Z","url":"/api/khu-vuc"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Failed to fetch zones: Unknown column 'so_ban' in 'field list'","method":"GET","stack":"Error: Failed to fetch zones: Unknown column 'so_ban' in 'field list'\n    at KhuVucModel.findAll (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\khuVuc.model.js:65:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async KhuVucService.getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\KhuVucService.js:26:12)\n    at async getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\khuVuc.controller.js:16:24)","timestamp":"2025-06-23T01:54:15.306Z","url":"/api/khu-vuc"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Failed to fetch zones: Unknown column 'so_ban' in 'field list'","method":"GET","stack":"Error: Failed to fetch zones: Unknown column 'so_ban' in 'field list'\n    at KhuVucModel.findAll (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\khuVuc.model.js:65:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async KhuVucService.getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\KhuVucService.js:26:12)\n    at async getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\khuVuc.controller.js:16:24)","timestamp":"2025-06-23T02:35:02.018Z","url":"/api/khu-vuc"}
{"ip":"::1","level":"error","message":"Unknown column 'ngay_tao' in 'field list'","method":"POST","stack":"Error: Unknown column 'ngay_tao' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at PhienSuDungBanModel.create (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\phienSuDungBan.model.js:14:31)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:48:12)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:47:21)","timestamp":"2025-06-23T03:06:11.485Z","url":"/api/phien-su-dung-ban"}
{"ip":"::1","level":"error","message":"Chỉ nhân viên hoặc quản lý mới có thể tạo đơn hàng","method":"POST","stack":"Error: Chỉ nhân viên hoặc quản lý mới có thể tạo đơn hàng\n    at DonHangService.createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\donHang.service.js:12:13)\n    at createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\donHang.controller.js:71:44)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\validate.js:28:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)","timestamp":"2025-06-23T03:16:00.447Z","url":"/api/don-hang"}
{"ip":"::1","level":"error","message":"Chỉ nhân viên hoặc quản lý mới có thể tạo đơn hàng","method":"POST","stack":"Error: Chỉ nhân viên hoặc quản lý mới có thể tạo đơn hàng\n    at DonHangService.createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\donHang.service.js:12:13)\n    at createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\donHang.controller.js:71:44)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\validate.js:28:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)","timestamp":"2025-06-23T03:18:24.653Z","url":"/api/don-hang"}
{"ip":"::1","level":"error","message":"Không tìm thấy chi tiết đơn hàng với chitiet_id cung cấp","method":"PATCH","stack":"Error: Không tìm thấy chi tiết đơn hàng với chitiet_id cung cấp\n    at ChiTietDonHangModel.update (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\chiTietDonHang.model.js:57:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async updateItemNote (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\donHang.controller.js:40:23)","timestamp":"2025-06-23T03:23:30.835Z","url":"/api/don-hang/items/%7B2%7D/ghichu"}
{"ip":"::1","level":"error","message":"Table session not found","method":"GET","stack":"Error: Table session not found\n    at PhienSuDungBanService.getPhienById (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:66:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async getPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:72:21)","timestamp":"2025-06-23T04:05:46.437Z","url":"/api/phien-su-dung-ban/loai-menu"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Failed to fetch zones: Unknown column 'so_ban' in 'field list'","method":"GET","stack":"Error: Failed to fetch zones: Unknown column 'so_ban' in 'field list'\n    at KhuVucModel.findAll (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\khuVuc.model.js:65:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async KhuVucService.getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\KhuVucService.js:26:12)\n    at async getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\khuVuc.controller.js:16:24)","timestamp":"2025-06-24T02:30:01.303Z","url":"/api/khu-vuc"}
{"ip":"::1","level":"error","message":"Failed to fetch zones: Unknown column 'so_ban' in 'field list'","method":"GET","stack":"Error: Failed to fetch zones: Unknown column 'so_ban' in 'field list'\n    at KhuVucModel.findAll (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\khuVuc.model.js:65:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async KhuVucService.getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\KhuVucService.js:26:12)\n    at async getAllKhuVuc (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\khuVuc.controller.js:16:24)","timestamp":"2025-06-24T02:32:48.193Z","url":"/api/khu-vuc"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'loai_menu' in 'field list'","method":"POST","stack":"Error: Unknown column 'loai_menu' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at PhienSuDungBanModel.create (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\phienSuDungBan.model.js:6:33)\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:52:38)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T02:40:51.073Z","url":"/api/phien-su-dung-ban"}
{"ip":"::1","level":"error","message":"loai_id must be an integer","method":"GET","stack":"Error: loai_id must be an integer\n    at LoaiMonAnService.getLoaiMonAnById (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\LoaiMonAnService.js:27:13)\n    at getLoaiMonAnById (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\LoaiMonAnController.js:22:46)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)","timestamp":"2025-06-24T03:48:59.852Z","url":"/api/loai-mon-an/loai_menu"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"PhienSuDungBanModel.findAll is not a function","method":"GET","stack":"TypeError: PhienSuDungBanModel.findAll is not a function\n    at PhienSuDungBanService.getActivePhienByBanId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:76:55)\n    at getActivePhienByBanId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:88:49)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T05:01:12.873Z","url":"/api/phien-su-dung-ban/active/by-table/5"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"loai_id must be an integer","method":"GET","stack":"Error: loai_id must be an integer\n    at LoaiMonAnService.getLoaiMonAnById (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\LoaiMonAnService.js:27:13)\n    at getLoaiMonAnById (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\LoaiMonAnController.js:22:46)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)","timestamp":"2025-06-24T05:13:06.672Z","url":"/api/loai-mon-an/loai_menu=Alacarte"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"loai_id must be an integer","method":"GET","stack":"Error: loai_id must be an integer\n    at LoaiMonAnService.getLoaiMonAnById (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\LoaiMonAnService.js:27:13)\n    at getLoaiMonAnById (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\LoaiMonAnController.js:22:46)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)","timestamp":"2025-06-24T05:13:41.069Z","url":"/api/loai-mon-an/loai_menu=Alacarte"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Cannot read properties of undefined (reading 'map')","method":"POST","stack":"TypeError: Cannot read properties of undefined (reading 'map')\n    at createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\donHang.controller.js:81:22)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\validate.js:28:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)","timestamp":"2025-06-24T05:33:22.904Z","url":"/api/don-hang"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T05:43:30.277Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'loai_id' in 'field list'","method":"POST","stack":"Error: Unknown column 'loai_id' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at DonHangModel.create (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\donHang.model.js:32:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async DonHangService.createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\donHang.service.js:31:21)\n    at async createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\donHang.controller.js:92:23)","timestamp":"2025-06-24T06:09:41.794Z","url":"/api/don-hang"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'loai_id' in 'field list'","method":"POST","stack":"Error: Unknown column 'loai_id' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at DonHangModel.create (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\donHang.model.js:32:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async DonHangService.createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\donHang.service.js:38:21)\n    at async createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\donHang.controller.js:92:23)","timestamp":"2025-06-24T06:14:36.818Z","url":"/api/don-hang"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'loai_id' in 'field list'","method":"POST","stack":"Error: Unknown column 'loai_id' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at DonHangModel.create (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\donHang.model.js:32:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async DonHangService.createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\donHang.service.js:38:21)\n    at async createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\donHang.controller.js:92:23)","timestamp":"2025-06-24T06:15:33.432Z","url":"/api/don-hang"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'loai_id' in 'field list'","method":"POST","stack":"Error: Unknown column 'loai_id' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at DonHangModel.create (C:\\Users\\A715-42G\\staff-order-backend\\src\\models\\donHang.model.js:32:35)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async DonHangService.createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\donHang.service.js:38:21)\n    at async createDonHang (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\donHang.controller.js:91:23)","timestamp":"2025-06-24T06:22:35.384Z","url":"/api/don-hang"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Không thể hủy vì phiên đã có đơn hàng được tạo.","method":"DELETE","stack":"Error: Không thể hủy vì phiên đã có đơn hàng được tạo.\n    at PhienSuDungBanService.cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:244:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:143:7)","timestamp":"2025-06-24T06:51:50.497Z","url":"/api/phien-su-dung-ban/20/cancel-empty"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T06:54:12.771Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T06:54:18.546Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T06:55:29.416Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"ChiTietDonHangService.getChiTietDonHangBySessionId is not a function","method":"GET","stack":"TypeError: ChiTietDonHangService.getChiTietDonHangBySessionId is not a function\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T07:08:19.387Z","url":"/api/chi-tiet-don-hang/by-session/21"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table 'stafforder.chi_tiet_don_hang' doesn't exist","method":"GET","stack":"Error: Table 'stafforder.chi_tiet_don_hang' doesn't exist\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:52:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T07:10:17.452Z","url":"/api/chi-tiet-don-hang/by-session/21"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'ma.ten_mon_an' in 'field list'","method":"GET","stack":"Error: Unknown column 'ma.ten_mon_an' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:52:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T07:12:40.058Z","url":"/api/chi-tiet-don-hang/by-session/21"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'ma.ten_mon_an' in 'field list'","method":"GET","stack":"Error: Unknown column 'ma.ten_mon_an' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:52:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T07:12:49.132Z","url":"/api/chi-tiet-don-hang/by-session/21"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'ma.ten_mon_an' in 'field list'","method":"GET","stack":"Error: Unknown column 'ma.ten_mon_an' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:52:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T07:12:57.076Z","url":"/api/chi-tiet-don-hang/by-session/21"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'dh.phien_su_dung_ban_id' in 'where clause'","method":"GET","stack":"Error: Unknown column 'dh.phien_su_dung_ban_id' in 'where clause'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:52:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T07:14:16.388Z","url":"/api/chi-tiet-don-hang/by-session/21"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'dh.phien_su_dung_ban_id' in 'where clause'","method":"GET","stack":"Error: Unknown column 'dh.phien_su_dung_ban_id' in 'where clause'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:52:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T07:14:22.319Z","url":"/api/chi-tiet-don-hang/by-session/21"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Không thể hủy vì phiên đã có đơn hàng được tạo.","method":"DELETE","stack":"Error: Không thể hủy vì phiên đã có đơn hàng được tạo.\n    at PhienSuDungBanService.cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:252:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:143:7)","timestamp":"2025-06-24T07:31:05.724Z","url":"/api/phien-su-dung-ban/20/cancel-empty"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T07:32:09.884Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T07:32:15.542Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T07:33:52.109Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Không thể hủy vì phiên đã có đơn hàng được tạo.","method":"DELETE","stack":"Error: Không thể hủy vì phiên đã có đơn hàng được tạo.\n    at PhienSuDungBanService.cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:252:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:143:7)","timestamp":"2025-06-24T07:35:21.422Z","url":"/api/phien-su-dung-ban/22/cancel-empty"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T07:39:00.965Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Không thể hủy vì phiên đã có đơn hàng được tạo.","method":"DELETE","stack":"Error: Không thể hủy vì phiên đã có đơn hàng được tạo.\n    at PhienSuDungBanService.cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:252:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:143:7)","timestamp":"2025-06-24T13:28:25.289Z","url":"/api/phien-su-dung-ban/25/cancel-empty"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T14:43:29.509Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'ctdh.so_luong_da_ra' in 'field list'","method":"GET","stack":"Error: Unknown column 'ctdh.so_luong_da_ra' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:58:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T15:55:24.755Z","url":"/api/chi-tiet-don-hang/by-session/30"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T16:03:14.547Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'dh.thoi_gian_tao' in 'field list'","method":"GET","stack":"Error: Unknown column 'dh.thoi_gian_tao' in 'field list'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:58:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T16:03:20.516Z","url":"/api/chi-tiet-don-hang/by-session/30"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Unknown column 'dh.nhanvien_id' in 'on clause'","method":"GET","stack":"Error: Unknown column 'dh.nhanvien_id' in 'on clause'\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:58:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T16:09:14.293Z","url":"/api/chi-tiet-don-hang/by-session/33"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table 'stafforder.phien' doesn't exist","method":"GET","stack":"Error: Table 'stafforder.phien' doesn't exist\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:60:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T16:28:12.615Z","url":"/api/chi-tiet-don-hang/by-session/34"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table 'stafforder.phien' doesn't exist","method":"GET","stack":"Error: Table 'stafforder.phien' doesn't exist\n    at PromisePool.query (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\mysql2\\lib\\promise\\pool.js:36:22)\n    at ChiTietDonHangService.getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\chiTietDonHang.service.js:60:31)\n    at getChiTietDonHangBySessionId (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\chiTietDonHang.controller.js:36:51)\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\role.js:26:5\n    at Layer.handleRequest (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\A715-42G\\staff-order-backend\\node_modules\\router\\lib\\route.js:157:13)\n    at authMiddleware (C:\\Users\\A715-42G\\staff-order-backend\\src\\middlewares\\auth.js:92:5)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T16:28:13.538Z","url":"/api/chi-tiet-don-hang/by-session/34"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Không thể hủy vì phiên đã có đơn hàng được tạo.","method":"DELETE","stack":"Error: Không thể hủy vì phiên đã có đơn hàng được tạo.\n    at PhienSuDungBanService.cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:252:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async cancelEmptyPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:143:7)","timestamp":"2025-06-24T16:30:17.859Z","url":"/api/phien-su-dung-ban/34/cancel-empty"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Table is not available","method":"POST","stack":"Error: Table is not available\n    at PhienSuDungBanService.createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:22:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async createPhien (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\phienSuDungBan.controller.js:76:21)","timestamp":"2025-06-24T18:13:55.103Z","url":"/api/phien-su-dung-ban"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"ChiTietDonHangModel.findAll is not a function","method":"POST","stack":"TypeError: ChiTietDonHangModel.findAll is not a function\n    at PhienSuDungBanService.calculateBill (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\phienSuDungBan.service.js:166:59)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async checkout (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\thanhToan.controller.js:16:20)","timestamp":"2025-06-24T18:18:56.504Z","url":"/api/thanh-toan/checkout"}
{"ip":"::ffff:127.0.0.1","level":"error","message":"Thiếu các trường bắt buộc: phien_id, so_tien, phuong_thuc","method":"POST","stack":"Error: Thiếu các trường bắt buộc: phien_id, so_tien, phuong_thuc\n    at ThanhToanService.createThanhToan (C:\\Users\\A715-42G\\staff-order-backend\\src\\services\\thanhToan.service.js:14:13)\n    at checkout (C:\\Users\\A715-42G\\staff-order-backend\\src\\controllers\\thanhToan.controller.js:25:48)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-24T18:22:09.245Z","url":"/api/thanh-toan/checkout"}
