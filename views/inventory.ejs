<%- include('header') %>
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <h2 class="mb-4 text-center">üì¶ Qu·∫£n L√Ω Kho</h2>
    </div>
  </div>
  <h2><%= editMaterialMode ? 'S·ª≠a Nguy√™n Li·ªáu' : editEquipmentMode ? 'S·ª≠a Thi·∫øt B·ªã' : 'Th√™m Nguy√™n Li·ªáu' %></h2>
  <% if (error) { %>
    <p class="text-danger"><%= error %></p>
  <% } %>
  <% if (editMaterialMode) { %>
    <form action="/admin/inventory/material" method="POST">
      <input type="hidden" name="nguyenlieu_id" value="<%= material.nguyenlieu_id %>">
      <label>T√™n Nguy√™n Li·ªáu</label>
      <input type="text" name="ten_nguyenlieu" value="<%= material.ten_nguyenlieu %>" required>
      <label>ƒê∆°n V·ªã</label>
      <input type="text" name="don_vi" value="<%= material.don_vi %>" required>
      <label>S·ªë L∆∞·ª£ng C√≤n L·∫°i</label>
      <input type="number" name="so_luong_con_lai" value="<%= material.so_luong_con_lai %>" required>
      <label>Ng∆∞·ª°ng C·∫£nh B√°o</label>
      <input type="number" name="nguong_canh_bao" value="<%= material.nguong_canh_bao %>" required>
      <button type="submit">C·∫≠p Nh·∫≠t</button>
    </form>
  <% } else if (editEquipmentMode) { %>
    <form action="/admin/inventory/equipment" method="POST">
      <input type="hidden" name="thietbi_id" value="<%= equipment.thietbi_id %>">
      <label>T√™n Thi·∫øt B·ªã</label>
      <input type="text" name="ten" value="<%= equipment.ten %>" required>
      <label>S·ªë L∆∞·ª£ng</label>
      <input type="number" name="so_luong" value="<%= equipment.so_luong %>" required>
      <label>Tr·∫°ng Th√°i</label>
      <select name="trang_thai" required>
        <option value="HoatDong" <%= equipment.trang_thai === 'HoatDong' ? 'selected' : '' %>>Ho·∫°t ƒê·ªông</option>
        <option value="DangSuaChua" <%= equipment.trang_thai === 'DangSuaChua' ? 'selected' : '' %>>ƒêang S·ª≠a Ch·ªØa</option>
        <option value="HuHong" <%= equipment.trang_thai === 'HuHong' ? 'selected' : '' %>>H·ªèng</option>
      </select>
      <button type="submit">C·∫≠p Nh·∫≠t</button>
    </form>
  <% } else { %>
    <h2>Th√™m Nguy√™n Li·ªáu</h2>
    <form action="/admin/inventory/addMaterial" method="POST">
      <label>T√™n Nguy√™n Li·ªáu</label>
      <input type="text" name="ten_nguyenlieu" required>
      <label>ƒê∆°n V·ªã</label>
      <input type="text" name="don_vi" required>
      <label>S·ªë L∆∞·ª£ng C√≤n L·∫°i</label>
      <input type="number" name="so_luong_con_lai" required>
      <label>Ng∆∞·ª°ng C·∫£nh B√°o</label>
      <input type="number" name="nguong_canh_bao" required>
      <button type="submit">Th√™m</button>
    </form>
    <h2>Th√™m Thi·∫øt B·ªã</h2>
    <form action="/admin/inventory/addEquipment" method="POST">
      <label>T√™n Thi·∫øt B·ªã</label>
      <input type="text" name="ten" required>
      <label>S·ªë L∆∞·ª£ng</label>
      <input type="number" name="so_luong" required>
      <label>Tr·∫°ng Th√°i</label>
      <select name="trang_thai" required>
        <option value="HoatDong">Ho·∫°t ƒê·ªông</option>
        <option value="DangSuaChua">ƒêang S·ª≠a Ch·ªØa</option>
        <option value="HuHong">H·ªèng</option>
      </select>
      <button type="submit">Th√™m</button>
    </form>
  <% } %>

  <h2>Danh S√°ch Kho</h2>
  <h3>Nguy√™n Li·ªáu</h3>
  <table>
    <thead>
      <tr>
        <th>T√™n</th>
        <th>ƒê∆°n V·ªã</th>
        <th>S·ªë L∆∞·ª£ng</th>
        <th>Ng∆∞·ª°ng C·∫£nh B√°o</th>
        <th>H√†nh ƒê·ªông</th>
      </tr>
    </thead>
    <tbody>
      <% if (materials && materials.length > 0) { %>
        <% materials.forEach(material => { %>
          <tr>
            <td><%= material.ten_nguyenlieu %></td>
            <td><%= material.don_vi %></td>
            <td><%= material.so_luong_con_lai %></td>
            <td><%= material.nguong_canh_bao %></td>
            <td>
              <a href="/admin/inventory/editMaterial/<%= material.nguyenlieu_id %>">C·∫≠p Nh·∫≠t</a>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr>
          <td colspan="5">Kh√¥ng c√≥ nguy√™n li·ªáu n√†o.</td>
        </tr>
      <% } %>
    </tbody>
  </table>

  <h3>Thi·∫øt B·ªã</h3>
  <table>
    <thead>
      <tr>
        <th>T√™n</th>
        <th>S·ªë L∆∞·ª£ng</th>
        <th>Tr·∫°ng Th√°i</th>
        <th>H√†nh ƒê·ªông</th>
      </tr>
    </thead>
    <tbody>
      <% if (equipments && equipments.length > 0) { %>
        <% equipments.forEach(equipment => { %>
          <tr>
            <td><%= equipment.ten %></td>
            <td><%= equipment.so_luong %></td>
            <td><%= equipment.trang_thai %></td>
            <td>
              <a href="/admin/inventory/editEquipment/<%= equipment.thietbi_id %>">C·∫≠p Nh·∫≠t</a>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr>
          <td colspan="4">Kh√¥ng c√≥ thi·∫øt b·ªã n√†o.</td>
        </tr>
      <% } %>
    </tbody>
  </table>

  <button onclick="toggleDarkMode()">Chuy·ªÉn ƒê·ªïi Ch·∫ø ƒê·ªô T·ªëi</button>
</div>
<%- include('footer') %>